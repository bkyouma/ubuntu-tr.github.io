

  





<!DOCTYPE html>
<html>
    <head>
        <title>Nagios Network Monitör Uygulaması</title>
        <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<link rel="stylesheet" href="theme/ubuntu-tr/css/main.css">
<link rel="stylesheet" href="theme/ubuntu-tr/css/ubuntu-tr.css">
<link rel="stylesheet" href="theme/ubuntu-tr/css/semantic.min.css">
<link rel="stylesheet" href="theme/ubuntu-tr/css/github-markdown.css">
<link rel="stylesheet" href="theme/ubuntu-tr/css/highlight.css">
<link rel="stylesheet" href="theme/ubuntu-tr/css/flexslider.css">
<script src="theme/ubuntu-tr/js/jquery-2.2.0.min.js"></script>
<script src="theme/ubuntu-tr/js/ubuntu-tr.js"></script>
<script src="theme/ubuntu-tr/js/jquery.flexslider-min.js"></script>

<!-- Chrome, Firefox OS and Opera -->
<meta name="theme-color" content="#dd4814">
<!-- Windows Phone -->
<meta name="msapplication-navbutton-color" content="#dd4814">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<link rel="icon" sizes="192x192" href="http://design.ubuntu.com/wp-content/uploads/ubuntu-logo32.png">

        <script src="theme/ubuntu-tr/js/relatedPosts.js"></script>
        <script src="theme/ubuntu-tr/js/jquery-ui.min.js"></script>
        <script src="theme/ubuntu-tr/js/tocify.js"></script>
        <link rel="stylesheet" href="theme/ubuntu-tr/css/tocify.css">
    </head>
    <body>
        <input type="checkbox" name="menuDugme" id="menuDugme1">
<header>
    <nav class="ustMenu">
        <a href="http://www.ubuntu-tr.net/">Anasayfa</a>
        <a href="https://forum.ubuntu-tr.net/">Forum</a>
        <a class="aktif" href="/">SUDO</a>
        <a href="http://wiki.ubuntu-tr.net/">Wiki</a>
        <a href="http://gezegen.ubuntu-tr.net/">Gezegen</a>
        <a href="http://www.ubuntu-tr.net/iletisim/">İletişim</a>
        <a href="https://forum.ubuntu-tr.net/index.php?topic=12295.0">Türkiye Tayfası</a>
        <a href="http://www.ubuntu-tr.net/tur/14.04/tr/index.html">Ubuntu Çevrimiçi Tur</a>
        <a href="http://webchat.freenode.net/?channels=ubuntu-tr-sohbet">Sohbet Kanalı</a>
    </nav>
    <nav class="menu">
        <a class="logo" href="">
            <label for="menuDugme1">
               <img src="theme/ubuntu-tr/images/menu.png" class="menuIcon"/>
            </label>
            sudo
        </a>
        <a href="/">Ana Sayfa</a>
        
        
	<a href="/haberler/">Haberler</a>

	<a href="/uygulama-tanitimlari/">Tanıtım</a>

	<a href="/nasil-yapilir/">Nasıl?</a>

	<a href="/oyun-eglence/">Oyun / Eğlence</a>

	<a href="/ubuntu+1/">Ubuntu+1</a>


        <a></a>
    </nav>
</header>

        <div class="ui container">
        <br /><br />
            <div class="ui grid equal width stackable">
                <div class="column">
                    <div class="ui card fluid">
                        <div class="content">
                            <h1 class="ui header">Nagios Network Monitör Uygulaması</h1>
                            <div class="meta">
                                <span><b class="ui sub header orange">Yazar:</b> Erkan Esmer</span>
                                <span><b class="ui sub header orange">Kategori:</b> <a href="/nasil-yapilir/">Nasıl?</a></span>
                                <span class="right floated">19 Nisan 2016 tarihinde yayımlandı.</span>
                            </div>
                            <div class="description">
                                Monitoring Sistemlerini inceleyeceğimiz bir yazı dizisine bu yazıyla başlıyoruz. İlk olarak Nagios uygulamasını inceleyeceğiz.
                            </div>
                        </div>
                        <div class="image">
                            <img src="images/post/nagios-1/1.jpg">
                        </div>
                        <div class="markdown-body">
                            <h2 id="monitoring-sistemleri">Monitoring Sistemleri</h2>

<blockquote class="onemli">
  <p><strong>Not:</strong> Nagios çalışmasını Centos sunucu izerinde yapmış olduğumuzdan dolayı kurulum ve yapılandırma tarifi Centos’a göredir.</p>
</blockquote>

<h3 id="nagios-network-monitr-uygulamas">Nagios Network Monitör Uygulaması</h3>

<p>Nagios, bir sistem ve ağ denetleme uygulamasıdır. Sunucu olarak belirlediğimiz makineye Nagios’u kurup izlemek, denetlemek istediğimiz makineye de agent (ajan) uygulamasını kurup gerekli konfigürasyonu yapar ve Nagios’u çalıştırırız.</p>

<p><strong>Genel olarak Nagios ile neler yapabiliriz?</strong></p>

<ol>
  <li>Ağ üzerinde istenilen makinelerin servislerini monitör edebilme. (Smtp,pop3, http, ping vs.)</li>
  <li>Makinelerin kaynaklarının durumlarını izleyebilme. (Disk kullanımı, İşlemci kullanımı vs.)</li>
  <li>Makine kaynaklarında veya servislerinde oluşabilecek durumlara karşı e-posta, SMS aracılığı ile bilgilendirme yapabilme.</li>
  <li>Network haritası çıkarabilme.</li>
  <li>Web arayüzü ile takip yapabilme ve rapor alabilme.</li>
</ol>

<p>Nagios’un diğer sağladıkları ve detaylar için www.nagios.org  adresine bakabilirsiniz.</p>

<h3 id="nagiosun-alma-ekli">Nagios’un Çalışma Şekli</h3>

<p>Nagios, uygulama olarak kurulduğu host makinede çalışır. Nagios’un üzerinde tanımlı pluginler vardır. Bu pluginler kurulumla beraber gelir. Kurulum sonrası monitör edilecek cihazları “.cfg” dosya türü ile Nagios’a tanımlarız (Nagios klasörünün altındaki object klasörü içine). Yani her izlenen cihazın bir .cfg uzantılı tanımlama dosyası olur. Bu tanımlama dosyaları da Nagios’un konfigürasyon dosyasında (Nagios klaösürü içindeki nagios.cfg dosyası) gösterilir.</p>

<p>Buna göre Nagios kendisinde tanımlı .cfg dosyaları sayesinde hangi ağ üzerindeki hangi cihazda hangi komutları çalıştıracağını bilir. Ayrıca çalıştıracağı komutlar da yine Nagios klasörünün altındaki object klasörünün içinde command.cfg dosyasında tutulur.</p>

<p>Sonuç olarak Nagios monitör ettiği cihazlarda birtakım pluginler çalıştırır. Bu pluginler de aslında komutlardan oluşur. Nagios çalıştırdığı pluginler sayesinde izlediği makineden bilgileri toplar ve bir web arayüzünde sunar.</p>

<p>Tabii bir de Nagios’un yukarıda bahsettiğimiz komutları karşı tarafta çalıştırabilmesi için eğer Unix/Linux makineyse NRPE eklentisini kurmak eğer Windows ise NSClient++ eklentisini kurmak gerekir. Bu eklentileri kurarak Nagios’un makinelere erişerek gerekli komutları çalıştırabilmesini sağlamış oluruz.</p>

<p>Nagios, <strong>5666</strong> numaralı port ile haberleşir.</p>

<h3 id="nagios-kurulumu">Nagios Kurulumu</h3>

<h4 id="kuruluma-hazrlk-ve-kurulum-admlar">Kuruluma Hazırlık ve Kurulum Adımları</h4>

<p>Öncelikle Nagios kurulumu için sistemimize repo ekleyeceğiz. Böylece eklediğimiz repodan Nagios ve Nagios-Plugin kurulumlarını yapacağız. Ayrıca web arayüzü için de Apache kurulumu yapacağız.</p>

<p><strong>Yani maddelendirirsek;</strong></p>

<ol>
  <li>repo ekleme</li>
  <li>Apache kurulumu</li>
  <li>Nagios ve Nagios-Plugin kurulumu</li>
</ol>

<p>En etkin repolar olan rpmforge ve epel repolarını veya birini sistemimize eklemek kurulum için yeterli. Bunun için biz şöyle bir yol izleyeceğiz. Tabii ki başka yöntemler de vardır.
Linux paketlerini arayıp indirebileceğimiz başarılı bir kaynak site olan pkgs.org sitesine girip arama alanından epel kelimesi aratalım. Çıkan sonuç aşağıdaki gibi olacaktır.</p>

<p><img src="images/post/nagios-1/EpelRepo.PNG" alt="" /></p>

<p>Bağlantıya tıkladığımızda açılan sayfada nasıl kuracağımıza dair yönlendirmeyi göreceğiz.</p>

<p><img src="images/post/nagios-1/EpelInstallHowto.PNG" alt="" /></p>

<p>Epel-release dosyasını indirip aynı konumdayken;</p>

<div class="highlighter-rouge"><pre class="highlight"><code>rpm -Uvh epel-release
</code></pre>
</div>

<p>komutunu vermemiz epel reposunun kurulumu için yeterlidir. Artık kurulum isteklerimiz epel reposundan da arattırılacaktır.</p>

<p>Son olarak Nagios kurulumuna başlamadan önce sistemimizde yoksa</p>

<div class="highlighter-rouge"><pre class="highlight"><code>yum install httpd
</code></pre>
</div>

<p>komutu ile Apache kurulumunu yapıyoruz. Apache ile ilgili sadece Nagios için kullanacağımız için ek ayarlar yapmayacağız. Kurulum yapmamız yeterli. Ardından</p>

<div class="highlighter-rouge"><pre class="highlight"><code>yum install nagios
</code></pre>
</div>

<p>komutunu veriyor ve Nagios kurulumu yapıyoruz.</p>

<p>Kurulum tamamlandıktan sonra /etc/nagios yoluna Nagios uygulamasının kurulduğunu görebilirsiniz. Şimdi Nagios dizinine bir bakalım.</p>

<p><img src="images/post/nagios-1/NagiosDizini.PNG" alt="" /></p>

<p>Buradaki dosya ve klasörler Nagios yapılandırılmasında kullanılan içerikleri ve dosyaları barındırır. Bunlara bakacak olursak; cgi.cfg  Bu dosyada web arayüzü için ayarlar bulunur. Temelde barındırdığı ayarlarla kullanabiliriz. Şimdilik bu dosyada ek bir şey yapmaya gerek yok. Nagios.cfg Bu dosya ile monitör edeceğimiz cihazların önceden yaptığımız .cfg dosyalarının yolunu belirtiriz. Böylece Nagios belirtilen .cfg dosyalarına göre monitörleme yapmaya başlar.</p>

<p>Passwd Kurulum sonrası web arayüz erişimi için KullanıcıAdı:nagiosadmin Şifre:nagiosadmin olarak gelir. Bu dosya şifrenin tutulduğu dosyadır.
Private Klasörü Private klasörü içinde resource.cfg dosyasını barındırır. Resource.cfg dosyası da Nagios Plugin dosyalarının yolunu tutar. Nagios bir plugin çalıştıracağı zaman plugin dosyasını bu dosyada belirtilen konumda arar.</p>

<p>Objects Klasörü Bu klasörde monitör ettiğimiz cihazların konfigürasyon dosyaları ve çalıştıracağımız komutların dosyası tutulur. İçerisinde localhost.cfg dosyasını windows.cfg dosyasını switch.cfg dosyasını görmekteyiz.</p>

<p>Örneğin windows.cfg dosyasına bir bakalım.</p>

<p><img src="images/post/nagios-1/windowsCfg-1.PNG" alt="" /></p>

<p>Dosyayı açtığımızda “Host Definitions” başlığı altında “define host {   }” parantezler arasına mönitör edeceğimiz Windows makinenin Grubunu (WindowsServer Grup diyebiliriz. WebArayüzde Windows grubu görmemizi sağlar.) Makine adını ve en önemlisi address başlığı karşısına ip_adresini yazarız.</p>

<p>Yukarıdaki girdilere göre ip_adresi 192.168.1.2 olan, adı winserver olan bir sunucumuzu windows-server grubunun içince mönitör etmek üzere belirtmiş olduk.
Devam ediyoruz;</p>

<p><img src="images/post/nagios-1/windowsCfg-2.PNG" alt="" /></p>

<p>Yukarıda bahsettiğimiz grup tanımının yapıldığı alan.
Unutmayalım! Eğer windows-servers grubu oluşturup bu grup altına sunucuları koyuyorsak bu grup tanımını sadece ilk oluşturduğumuz dosyada yapacağız. İlk dosya ile beraber grup tanımı yapılmış olacak. Diğer dosyalarda yukarıda değindiğimiz gibi sadece üye olduğu grubu belirteceğiz.
Aksi hâlde her dosyada bir grup tanımlamaya çalışırsak aynı isimli grupolacağından hata alırız.</p>

<p>Yine windows.cfg dosyaında devem ediyoruz. Aşağıda iki adet servis tanımı görmekteyiz. Biri UPTIME girdisi ile sunucunun uptime zamanına bakmakta diğeri ise CPULOAD girdisi ile işlemci yüküne bakmakta. Bunları aşağıda görülen formatta dilediğimiz kadar çoğaltabilir ve sununcunun istediğimiz servisini veya durumu izlemeye alabiliriz.</p>

<p><img src="images/post/nagios-1/windowsCfg-3.PNG" alt="" /></p>

<p>İşte windows.cfg dosyasını Windows olan her sunucumuz için kullanabiliriz. Diğer dosyalar da adından da anlaşılacağı üzere switch.cfg, switch kontrolleri için printer.cfg dosyası printer cihazların kontrolleri için şablon .cfg dosyalarıdır. Bu dosyaları cihazlarımıza göre özelleştirerek kullanabiliriz.
Örneğin yukarıda içeriğine baktığımız windows.cfg dosyasını içeriğini düzenleyip adını da sunucumuz ismini vererek kaydeder ve kullanabiliriz. Örn:FileServer-1</p>

<p>Son olarak bu .cfg dosyasının yolunu /etc/nagios/ altında bulunan nagios.cfg dosyasına ekliyoruz.</p>

<p><img src="images/post/nagios-1/NagiosCfg-1.PNG" alt="" /></p>

<p>Nagios yukarıda da anlattığımız gibi .cfg dosyasına ulaşarak, içeriğine göre izlemeyi başlatıyor.
Mesela kendi oluşturduğumuz dosyanın adını FileServer-1.cfg olarak vermiş olalım. nagios.cfg dosyasında oluşacak girdi aşağıdaki gibi olacak.</p>

<p><img src="images/post/nagios-1/NagiosCfg-2.PNG" alt="" /></p>

<p>Temel olarak Nagios Sunucusunda yapacağımız ayarlar ve düzenlemelere değindik. Bir de izlenecek tarafta izlemenin sağlanabilmesi için eklenti bir uygulama kurulması gerekiyor.
Windows sunucular için <a href="http://sourceforge.net/projects/nscplus/">http://sourceforge.net/projects/nscplus/</a>  adresinden NSClient++ kurulumunu indiriyoruz ve sunucuda kuruyoruz. Kurulum sırasında bize Nagios sunucunun ip adresi soruluyor. Bu bilgiyi de girdiğimizde ve kurulum tamamlandığında izlenecek makine izlenmeye hazır duruma geliyor. Monitör edilecek makine tarafında başka bir ayar yapmamıza gerek yok. Yalnız kurulumun başarılı şekilde tamamlandığını kontrol etmek için şunu yapabiliriz.</p>

<p>Windows komut satırında;</p>

<div class="highlighter-rouge"><pre class="highlight"><code>netstat -an |find /i “:5666” komutunu çalıştırır ve LISTENING dönüşü alırsak problem yok demektir.
**Nagios 5666 portundan çalışır.
</code></pre>
</div>

<p>Eğer Linux bir makineyi monitor edeceksek aynı Windows makineye kurduğumuz gibi bir uygulamayı da Linux makinemize kuruyoruz.
Yum install nagios-nrpe komutu ile kurulumu yapıyoruz. Kurulum bittikten sonra /etc/nagios/ klasöri altına nrpe.cfg dosyasının geldiğini göreceğiz. Bu dosyayı edit edip AllowedHosts tanımına Nagios Server makinenin ip_adresini girmemizle monitörleme için karşı cihazda gerekenleri yapmış oluruz.</p>

<p>Yine kontrol için terminal penceresinde;</p>

<div class="highlighter-rouge"><pre class="highlight"><code>netstat -an |grep 5666 komutunu çalıştırdığımızda LISTEN sonucunu alırsak  kurulum başarılı demektir.
</code></pre>
</div>

<p>Bu ayki yazımızda Nagios için kurulum ve yapılandırma yaptık. Temel olarak çalışır duruma getirdik. Önümüzdeki ay yine Nagios’tan devam ederek bir senaryo işleteceğiz. Windows, Linux makinelerimizi monitörlemeye alacak bunun yanına switch izleme de eklemeye çalışacağız. Bu çalışmayı da tamamlayınca web arayüzden Nagios uygulamamızı kullanacağız.</p>

<p>Görüşmek üzere…</p>

                        </div>
                        <div class="extra content ui labels grey basic tiny">
                            


    
    
    <a href="/etiket/sudo-53-sayi" class="ui label"> Sudo 53. Sayı </a>

    
    
    <a href="/etiket/ag-izleme" class="ui label"> ağ izleme </a>


                        </div>
                    </div>
                    <div class="ui segment">
                        <div id="disqus_thread"></div>
                        <script>
                            /**
                             *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
                             *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
                             */
                            var disqus_config = function () {
                                this.page.identifier = '/nagios-1';
                            };
                            (function() {  // DON'T EDIT BELOW THIS LINE
                                var d = document, s = d.createElement('script');

                                s.src = '//bugra9.disqus.com/embed.js';

                                s.setAttribute('data-timestamp', +new Date());
                                (d.head || d.body).appendChild(s);
                            })();
                        </script>
                    </div>
                </div>
                <div class="column five wide computer only">
                    <h3 class="ui header orange dividing">
                      Benzer Yazılar
                    </h3>
                    <div id="rp" class="ui items divided link">

                    </div>
                    <div id="toc" class="ui items divided link">

                    </div>

                </div>
            </div>
        </div>
        <footer>
    <nav>
        <div>
            <a href="https://ubuntu-tr.net/">Anasayfa</a>
            <a href="https://ubuntu-tr.net/bize-katilin/">Bize Katılın!</a>
            <a href="https://ubuntu-tr.net/iletisim/">İletişim</a>
            <a href="https://ubuntu-tr.net/indir/">İndir</a>
            <a href="https://ubuntu-tr.net/ubuntu-hakkinda/">Ubuntu Hakkında</a>
        </div>
        <div>
            <a href="https://forum.ubuntu-tr.net/">Forum</a>
            <a href="https://forum.ubuntu-tr.net/index.php?action=login">Giriş Yap</a>
            <a href="https://forum.ubuntu-tr.net/index.php?board=2.0">Duyurular</a>
            <a href="https://forum.ubuntu-tr.net/index.php?board=142.0">Acemiler için İlk Durak</a>
            <a href="https://forum.ubuntu-tr.net/index.php?topic=12295.0">Türkiye Tayfası</a>
        </div>
        <div>
            <a href="https://sudo.ubuntu-tr.net/">SUDO</a>
            <a href="https://sudo.ubuntu-tr.net/hakkinda/">Hakkında</a>
            <a href="https://sudo.ubuntu-tr.net/sudo-tayfasi/">SUDO Tayfası</a>
            <a href="https://sudo.ubuntu-tr.net/yazar-ol/">Yazar Ol</a>
            <a href="https://sudo.ubuntu-tr.net/butun-sayilar/">Bütün Sayılar</a>
        </div>
        <div>
            <a href="http://wiki.ubuntu-tr.net/index.php?title=Ana_Sayfa">Wiki</a>
            <a href="http://wiki.ubuntu-tr.net/index.php?title=Ubuntu">Ubuntu Nedir?</a>
            <a href="http://wiki.ubuntu-tr.net/index.php?title=Kurulum">Kurulum</a>
            <a href="http://wiki.ubuntu-tr.net/index.php?title=Windows%27tan_Ubuntu%27ya_ge%C3%A7i%C5%9F">Windows’tan Ubuntu’ya Geçiş</a>
        </div>
        <div>
            <a href="http://gezegen.ubuntu-tr.net/">Gezegen</a>
            <a href="http://gezegen.ubuntu-tr.net/basliklar">Tüm Başlıklar</a>
            <a href="http://gezegen.ubuntu-tr.net/kunye/">Künye</a>
            <a href="http://gezegen.ubuntu-tr.net/feed">RSS</a>
            <a href="https://forum.ubuntu-tr.net/index.php?topic=17310.0">Gezegen’e Başvur</a>
        </div>
        <div>
            <a href="http://www.ubuntu.com/">Ubuntu</a>
            <a href="http://askubuntu.com/">AskUbuntu</a>
            <a href="http://ubuntuforums.org/">Ubuntu Forums</a>
            <a href="http://www.ubuntu.com/download">Download</a>
            <a href="https://launchpad.net/">Launchpad</a>
        </div>
    </nav>
    <div class="ayirac"></div>
    <div class="bilgi">
        <img src="theme/ubuntu-tr/images/GitHub-Mark-120px-plus.png" />
        <p>Ubuntu-TR Sudo <a href="https://github.com/ubuntu-tr/ubuntu-tr.github.io">Github</a> desteği ile barındırılmaktadır.</p>
        <p>Tasarım: <a href="https://ubuntu-tr.net/">Ubuntu Türkiye</a> • Alt yapı: <a href="https://jekyllrb.com/">Jekyll</a></p>
        <img src="theme/ubuntu-tr/images/cc-by-sa2.png" />
        <p>Bu sitedeki makaleler <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA</a> lisansı altındadır.</p>
    </div>

</footer>


    </body>
</html>
