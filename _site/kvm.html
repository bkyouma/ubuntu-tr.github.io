

  





<!DOCTYPE html>
<html>
    <head>
        <title>Ev Kullanıcıları İçin KVM</title>
        <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<link rel="stylesheet" href="theme/ubuntu-tr/css/main.css">
<link rel="stylesheet" href="theme/ubuntu-tr/css/ubuntu-tr.css">
<link rel="stylesheet" href="theme/ubuntu-tr/css/semantic.min.css">
<link rel="stylesheet" href="theme/ubuntu-tr/css/github-markdown.css">
<link rel="stylesheet" href="theme/ubuntu-tr/css/highlight.css">
<link rel="stylesheet" href="theme/ubuntu-tr/css/flexslider.css">
<script src="theme/ubuntu-tr/js/jquery-2.2.0.min.js"></script>
<script src="theme/ubuntu-tr/js/ubuntu-tr.js"></script>
<script src="theme/ubuntu-tr/js/jquery.flexslider-min.js"></script>

<!-- Chrome, Firefox OS and Opera -->
<meta name="theme-color" content="#dd4814">
<!-- Windows Phone -->
<meta name="msapplication-navbutton-color" content="#dd4814">
<!-- iOS Safari -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<link rel="icon" sizes="192x192" href="http://design.ubuntu.com/wp-content/uploads/ubuntu-logo32.png">

        <script src="theme/ubuntu-tr/js/relatedPosts.js"></script>
        <script src="theme/ubuntu-tr/js/jquery-ui.min.js"></script>
        <script src="theme/ubuntu-tr/js/tocify.js"></script>
        <link rel="stylesheet" href="theme/ubuntu-tr/css/tocify.css">
    </head>
    <body>
        <input type="checkbox" name="menuDugme" id="menuDugme1">
<header>
    <nav class="ustMenu">
        <a href="http://www.ubuntu-tr.net/">Anasayfa</a>
        <a href="https://forum.ubuntu-tr.net/">Forum</a>
        <a class="aktif" href="/">SUDO</a>
        <a href="http://wiki.ubuntu-tr.net/">Wiki</a>
        <a href="http://gezegen.ubuntu-tr.net/">Gezegen</a>
        <a href="http://www.ubuntu-tr.net/iletisim/">İletişim</a>
        <a href="https://forum.ubuntu-tr.net/index.php?topic=12295.0">Türkiye Tayfası</a>
        <a href="http://www.ubuntu-tr.net/tur/14.04/tr/index.html">Ubuntu Çevrimiçi Tur</a>
        <a href="http://webchat.freenode.net/?channels=ubuntu-tr-sohbet">Sohbet Kanalı</a>
    </nav>
    <nav class="menu">
        <a class="logo" href="">
            <label for="menuDugme1">
               <img src="theme/ubuntu-tr/images/menu.png" class="menuIcon"/>
            </label>
            sudo
        </a>
        <a href="/">Ana Sayfa</a>
        
        
	<a href="/haberler/">Haberler</a>

	<a href="/uygulama-tanitimlari/">Tanıtım</a>

	<a href="/nasil-yapilir/">Nasıl?</a>

	<a href="/oyun-eglence/">Oyun / Eğlence</a>

	<a href="/ubuntu+1/">Ubuntu+1</a>


        <a></a>
    </nav>
</header>

        <div class="ui container">
        <br /><br />
            <div class="ui grid equal width stackable">
                <div class="column">
                    <div class="ui card fluid">
                        <div class="content">
                            <h1 class="ui header">Ev Kullanıcıları İçin KVM</h1>
                            <div class="meta">
                                <span><b class="ui sub header orange">Yazar:</b> Çağrı Emer</span>
                                <span><b class="ui sub header orange">Kategori:</b> <a href="/nasil-yapilir/">Nasıl?</a></span>
                                <span class="right floated">19 Nisan 2016 tarihinde yayımlandı.</span>
                            </div>
                            <div class="description">
                                
                            </div>
                        </div>
                        <div class="image">
                            <img src="images/post/kvm/1.png">
                        </div>
                        <div class="markdown-body">
                            <p>Bundan altı sene önce 2.6.20 çekirdeği ile kullanıma sunulan KVM (kernel-based virtual machines) 2010 civarına kadar geçen süre zarfında çekirdeğe eklenmiş en heyecan verici değişiklik olarak addediliyordu. Duyurulmasından bu yana gün geçtikçe daha kararlı hale gelen ve hızlanan KVM günümüzde pekçok sanallaştırma probleminin altından kalkabiliyor.</p>

<p>KVM’i makinemizde çalıştırabilmemiz için gereken tek ön koşul işlemcimizin sanallaştırma uzantılarını destekliyor olması. INTEL işlemciler için vmx, AMD işlemciler için ise svm adı verilen CPU bayrağı eğer /proc/cpuinfo çıktınızda mevcutsa işlemciniz sanallaştırma uzantılarını destekliyor demektir. Kontrolü şu komut ile yapabilirsiniz.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>egrep -c '(vmx|svm)' /proc/cpuinfo
</code></pre>
</div>

<p>Eğer 0’dan farklı bir sayı görüyorsanız yazının geri kalanındaki komutları çalıştırmanızda bir sakınca yok. Eğer çıktı 0 işe ne yazık ki işlemcinizin sanallaştırma uzantısı desteği yoktur.(Not:BIOS’unuzdan sanallaştırma desteğinin açıldığına emin olun)</p>

<p>Yazının geri kalanında kurumsal ihtiyaçlara yönelik KVM senaryoları yerine ev kullanıcısının ihtiyacını görecek bir senaryo işlenip KVM’e kısa da olsa bir giriş yapılmaya çalışılacaktır.</p>

<h3 id="peki-kvm-hangi-konuk-iletim-sistemlerini-altrabiliyor">Peki KVM hangi konuk işletim sistemlerini çalıştırabiliyor?</h3>

<p>Windows XP’den Android’e, Slackware’den OpenBSD’ye, Solaris’ten Amiga’ya kadar uzanan geniş bir yelpazede aklınıza gelebilecek hemen hemen her işletim sistemini çalıştırabiliyor. Tüm listeye proje sayfasından <strong>[1]</strong> ulaşmak mümkün. Gelelim KVM’in konak makinemize kurulumunun nasıl yapılacağına. Ubuntu her zaman olduğu gibi bu sefer de işimizi çok kolaylaştırıyor. Yüklememiz gereken paketler şunlar.</p>

<table>
  <thead>
    <tr>
      <th>Paket</th>
      <th>İşlevi</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>qemu-kvm</td>
      <td>sanallaştırma görevini yapacak yazılım</td>
    </tr>
    <tr>
      <td>libvirt-bin</td>
      <td>servisleri başlatmak gibi işlevleri görecek yazılımlar</td>
    </tr>
    <tr>
      <td>virt-manager</td>
      <td>sanal makineleri oluşturmak ve kontrol etmek için grafik arayüz</td>
    </tr>
  </tbody>
</table>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo apt-get update
sudo apt-get install qemu-kvm libvirt-bin virt-manager
</code></pre>
</div>

<p>Kullanıcımızın libvirtd grubuna eklendiğine emin olalım. Bunun için şu komutu çalıştırabiliriz.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>groups | grep -c libvirtd
</code></pre>
</div>

<p>Eğer yukarıdaki komut 1 çıktısını verirse kullanıcımızı libvirtd grubuna dahil edilmiştir. Eğer çıktı sıfırsa kendimizi libvirtd grubuna ekleyelim ki sanal makine oluşturup yönetebilelim. Bunu da şu komutla gerçekleştiriyoruz.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>sudo adduser `id-in` libvirtd
</code></pre>
</div>

<p>Şimdi bilgisayarı yeniden başlatalım. Bu işlem de tamamlandıktan sonra DASH’e virt-manager yazdığımızda görünecek olacak Virtual Machine Manager aracını başlatabiliriz. Eğer her şey yolunda gittiyse bizi şuna benzer bir ekran karşılayacaktır.</p>

<p><img src="images/post/kvm/01.png" alt="" /></p>

<p>KVM ilk kurulumda bizim için NAT ile internete çıkan bir sanal ağ oluşturur. Yani modemimizden doğrudan her sanal makine için IP almak yerine konak makinemizin IP adresini kullanmış oluruz dış ağ için. Bu ağ aygıtı muhtemelen ifconfig çıktısında virbr0 ile ifade edilecektir. Benim bulunduğum ağda DHCP sunucu 10.0.0.0/8 uzayını dağıtmakta. virbr0 sanal ağ aygıtımız ise 192.168.122.0/24 uzayından sanal makinelere IP adreslerini dağıtacak şekilde yapılandırılmış. (varsayılan olarak bu şekilde geliyor) Dolayısıyla aslında yeni bir sanal ağ oluşturmamıza gerek yok. Fakat daha önce de söylediğim üzere temel ihtiyaçları görecek bir senaryo üzerinde duracağımızdan bir adet sanal ağ oluşturup ardından sanal makinelerin yapılandırılmasına geçeceğiz. Virtual Networks sekmesinde sol altta bulunan yeşil + işaretine bastığımızda şu ekranı görmeliyiz.</p>

<p><img src="images/post/kvm/02.png" alt="" /></p>

<p>Forward ile devam ediyoruz ve bize bir ağ adı soruyor. Buraya istediğimiz isimi yazabiliriz. Ben sudotestagi yazıp Forward diyorum.</p>

<p><img src="images/post/kvm/03.png" alt="" /></p>

<p>Gelen ekranda IP uzayımızı seçeceğiz. Genelde ev kullanıcıları için üretilmiş modemler 10.0.0.0/8 ya da 192.168.0.0/16 uzayını kullandığından bu örneğimizde 172.16.0.0./12 uzayından bir aralık seçeceğiz. Örneğin 172.16.20.0/24 Bu sayede 172.16.20.2’den 172.16.20.254’e kadar olan IP’leri sanal makinelerimize atayabileceğiz.</p>

<p><img src="images/post/kvm/04.png" alt="" /></p>

<p>Bir sonraki ekranda DHCP kullanmak isteyip istemediğimiz sorulacak. Eğer sanal makinelere statik IP atamak istemiyorsak kullanmamız yerinde olacaktır. 100 - 200 aralığını dağıtmasını isteyip Forward ile devam ediyoruz.</p>

<p><img src="images/post/kvm/05.png" alt="" /></p>

<p>Geldik en önemli adıma. Bu ekranda daha önce de belirttiğimiz üzere fiziksel ağımıza NAT yapmasını söyleyeceğiz sanal ağımızın. Ayarları aşağıdaki gibi değiştiriyoruz. Eğer internete bağlandığımız aygıt resimde gördüğümüz gibi eth0 değilse, örneğin wlan0 ise, onu seçmemiz gerekiyor.</p>

<p><img src="images/post/kvm/06.png" alt="" /></p>

<p>Forward dediğimizde bize oluşturduğumuz ağın bir özetini gösteriyor. Finish ile devam ediyoruz.</p>

<p><img src="images/post/kvm/07.png" alt="" /></p>

<p>Bu adım yukarıda da belirttiğim üzere opsiyonel bir adım çünkü varsayılan olarak oluşturduğu default ağı da işimizi görecektir. Sadece yeni bir ağın nasıl oluşturulduğunu görmeye çalıştık. Varsayılan olarak sanal makinelere ait disk dosyaları /var/lib/libvirt/images dizini altında tutulur. Sanal makine yöneticisindeki Storage sekmesinde bu dizinin bulunduğu diskte ne kadar yeriniz olduğunu görebilirsiniz. Ben örnek sanal makine olarak PC-BSD 9.1 deneyeceğim. İlk olarak konuk makinemizin diskini oluşturalım.</p>

<p><img src="images/post/kvm/08.png" alt="" /></p>

<p>Storage sekmesinde sağ altta bulunan New Volume tuşuna basıyor ve şuna benzer olacak şekilde dolduruyoruz.</p>

<p><img src="images/post/kvm/09.png" alt="" /></p>

<p>İsim kısımına istediğiniz isimi verebilirsiniz. Formatı raw olarak bırakmanızda bir sakınca yok. Capacity diskinizin büyüklüğünü belirtiyor. Allocation ise şu aşamada ne kadar alanı gerçekten diske tahsis ettiğinizi belirtiyor. Burada ikisine de aynı değeri verip bir sonraki aşamada gerçekten ayırdığımız alanı oluşturmasını bekleyeceğiz. Diskin oluşturulması bittikten sonra sıra yeni işletim sistemimiz için kaynak ayırılmasına geliyor. Fakat önce elimizde ne var kontrol edelim.</p>

<p>Kuracağımız konuk işletim sisteminin .iso dosyası, yeni bir sanal ağımız ve kurulum için kullanacağımız disk alanımız. Eğer bu üçünden biri eksikse yukarıdaki adımlardan birini eksik yapmışsınız demektir. Yok değilse sanal makine yöneticisine gelip üzerinde play tuşuna benzer üçgen işareti olan monitör tuşuna basıyoruz. (Create a new virtual machine) Bize makinemize vereceğimiz isimi ve ne şekilde kurulum yapacağımızı soruyor. Elimizde .iso dosyası olduğundan onu seçiyoruz ve  Forward tuşuna basıyoruz. Gelen ekranda kurulum imajının bulunduğu dizini göstermemiz gerekiyor. OS type ve version çok önemli değiller fakat kurulumunu yaptığınız işletim sistemi ya da benzeri bir işletim sistemini gösterebilirsiniz.</p>

<p><img src="images/post/kvm/11.png" alt="" /></p>

<p>Bir sonraki ekranda sanal makine için ayıracağımız RAM ve CPU değerlerini seçiyoruz. Ben 1.5 GB RAM ve 2 CPU vereceğim.</p>

<p><img src="images/post/kvm/12.png" alt="" /></p>

<p>Sonraki ekranımız disk seçimini yaptığımız ekran. Burada ister yeni bir disk oluşturur istersek de daha önce oluşturduğumuz diski seçebiliriz. Biz daha önce oluşturduğumuzdan ikinci seçenekle devam ediyoruz.</p>

<p><img src="images/post/kvm/13.png" alt="" /></p>

<p>Sonraki aşamada bize oluşturacağımız sanal makinenin bir özetini gösteriyor. Burada Advanced Options altında kendi oluşturduğumuz sanal ağı seçeceğiz ve Finish ile sanal makine oluşturma işini tamamlayacağız.</p>

<p><img src="images/post/kvm/14.png" alt="" /></p>

<p>Eğer her şey yolunda gittiyse bizi aşağıdaki gibi PC-BSD iso’sundan açtığı bir konsol ekranı karşılayacak. PC-BSD kurulumuna burada değinmeyeceğiz.</p>

<p>Bu aşamada hata alırsanız aldığınız hata RAM miktarınız ile ilgili olabilir. Bilgisayarınızdaki fiziksel RAM konak işletim sistemi ve konuk işletim sistemlerinize ayırdığınız RAM kadar ya da daha büyük olmalı. Yani konak makinenin çalışması için gereken RAM miktarını ihmal etmeyin. Eğer kernel modülünün yüklenemediği ile alakalı bir hata alırsanız bilgisayarınızı yeniden başlatmayı deneyin.</p>

<p><img src="images/post/kvm/15.png" alt="" /></p>

<p>Makinemiz çalışırken sanal makine yöneticisinde şu şekilde gözükecektir.</p>

<p><img src="images/post/kvm/16.png" alt="" /></p>

<p>Sanal makinenin konsol ekranından kaçmak için klavyenin sol tarafındaki CTRL ve ALT tuşlarına aynı anda basmamız yeterli olacaktır. Ben 10GB alan ile PC-BSD GNOME’da problem yaşadım. X ile ilgili de kısmi sorunlar çıktığından gdm’i kapatıp, sshd’yi aktif ettikten sonra pf’i devre dışı bırakarak konak makineden SSH ile kullanıcıma eriştim. root ile erişmek için bir de sshd_config dosyasını düzenlemelisiniz.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>/usr/local/etc/rc.d/gdm stop
root olarak giriş yapın
nano /etc/rc.conf (sshd_enable="YES")
pfctl -d
</code></pre>
</div>

<p><img src="images/post/kvm/17.png" alt="" /></p>

<p>Öte yandan CentOS, Ubuntu gibi sistemlerde yaptığım denemelerde herhangi bir sorun çıkmadı. Sanal makineleri kapatmak için normal işletim sistemimizi kapatırmış gibi kendi menülerini kullanabilir ya da sanal makine konsolunu görüntüleyen alanın üzerindeki kırmızı açma kapama tuşundan ilgili seçeneği seçebiliriz. Yine sanal makine konsolunun bulunduğu ekranın üst tarafında bulunan i tuşu ile sanal makinemize ait özellikleri inceleyebilir ve değiştirebiliriz. Kapalı sanal makineleri başlatmak için virt-manager’ı çalıştırıp ilgili sanal makineye sağ tıkladıktan sonra çalıştır dememiz yeterli olacaktır.</p>

<p>KVM genel hatlarıyla işte bu kadar basit. Ubuntu 3 paket sayesinde sisteme çok güçlü bir sanallaştırma çözümü eklememize izin veriyor. Kickstart ile kurulumların otomatikleştirildiği bir KVM ortamında sanal makine provizyonu yapmak da oldukça kolay. Üstelik yukarıdaki işlemlerin tümünü komut satırından da gerçekleştirebileceğimizden uzaktaki makinelerle çalışmak gerçekten kolaylaşıyor.</p>

<p>Yazıyı burada bitirirken VirtualBox’a alternatif olarak KVM kullanmanız için gereken tüm bilgileri paylaştığımızı umuyoruz. Yaşadığınız sorunları her zamanki gibi forumumuzda dile getirebilirsiniz.</p>

<h6 id="kaynak">Kaynak:</h6>
<p>[1] <a href="http://www.linux-kvm.org/page/Guest_Support_Status">http://www.linux-kvm.org/page/Guest_Support_Status</a></p>

                        </div>
                        <div class="extra content ui labels grey basic tiny">
                            


    
    
    <a href="/etiket/sudo-51-sayi" class="ui label"> Sudo 51. Sayı </a>

    
    
    <a href="" class="ui label">  </a>

    
    
    <a href="/etiket/sanal-makine" class="ui label"> sanal makine </a>

    
    
    <a href="/etiket/kvm" class="ui label"> KVM </a>


                        </div>
                    </div>
                    <div class="ui segment">
                        <div id="disqus_thread"></div>
                        <script>
                            /**
                             *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
                             *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
                             */
                            var disqus_config = function () {
                                this.page.identifier = '/kvm';
                            };
                            (function() {  // DON'T EDIT BELOW THIS LINE
                                var d = document, s = d.createElement('script');

                                s.src = '//bugra9.disqus.com/embed.js';

                                s.setAttribute('data-timestamp', +new Date());
                                (d.head || d.body).appendChild(s);
                            })();
                        </script>
                    </div>
                </div>
                <div class="column five wide computer only">
                    <h3 class="ui header orange dividing">
                      Benzer Yazılar
                    </h3>
                    <div id="rp" class="ui items divided link">

                    </div>
                    <div id="toc" class="ui items divided link">

                    </div>

                </div>
            </div>
        </div>
        <footer>
    <nav>
        <div>
            <a href="https://ubuntu-tr.net/">Anasayfa</a>
            <a href="https://ubuntu-tr.net/bize-katilin/">Bize Katılın!</a>
            <a href="https://ubuntu-tr.net/iletisim/">İletişim</a>
            <a href="https://ubuntu-tr.net/indir/">İndir</a>
            <a href="https://ubuntu-tr.net/ubuntu-hakkinda/">Ubuntu Hakkında</a>
        </div>
        <div>
            <a href="https://forum.ubuntu-tr.net/">Forum</a>
            <a href="https://forum.ubuntu-tr.net/index.php?action=login">Giriş Yap</a>
            <a href="https://forum.ubuntu-tr.net/index.php?board=2.0">Duyurular</a>
            <a href="https://forum.ubuntu-tr.net/index.php?board=142.0">Acemiler için İlk Durak</a>
            <a href="https://forum.ubuntu-tr.net/index.php?topic=12295.0">Türkiye Tayfası</a>
        </div>
        <div>
            <a href="https://sudo.ubuntu-tr.net/">SUDO</a>
            <a href="https://sudo.ubuntu-tr.net/hakkinda/">Hakkında</a>
            <a href="https://sudo.ubuntu-tr.net/sudo-tayfasi/">SUDO Tayfası</a>
            <a href="https://sudo.ubuntu-tr.net/yazar-ol/">Yazar Ol</a>
            <a href="https://sudo.ubuntu-tr.net/butun-sayilar/">Bütün Sayılar</a>
        </div>
        <div>
            <a href="http://wiki.ubuntu-tr.net/index.php?title=Ana_Sayfa">Wiki</a>
            <a href="http://wiki.ubuntu-tr.net/index.php?title=Ubuntu">Ubuntu Nedir?</a>
            <a href="http://wiki.ubuntu-tr.net/index.php?title=Kurulum">Kurulum</a>
            <a href="http://wiki.ubuntu-tr.net/index.php?title=Windows%27tan_Ubuntu%27ya_ge%C3%A7i%C5%9F">Windows’tan Ubuntu’ya Geçiş</a>
        </div>
        <div>
            <a href="http://gezegen.ubuntu-tr.net/">Gezegen</a>
            <a href="http://gezegen.ubuntu-tr.net/basliklar">Tüm Başlıklar</a>
            <a href="http://gezegen.ubuntu-tr.net/kunye/">Künye</a>
            <a href="http://gezegen.ubuntu-tr.net/feed">RSS</a>
            <a href="https://forum.ubuntu-tr.net/index.php?topic=17310.0">Gezegen’e Başvur</a>
        </div>
        <div>
            <a href="http://www.ubuntu.com/">Ubuntu</a>
            <a href="http://askubuntu.com/">AskUbuntu</a>
            <a href="http://ubuntuforums.org/">Ubuntu Forums</a>
            <a href="http://www.ubuntu.com/download">Download</a>
            <a href="https://launchpad.net/">Launchpad</a>
        </div>
    </nav>
    <div class="ayirac"></div>
    <div class="bilgi">
        <img src="theme/ubuntu-tr/images/GitHub-Mark-120px-plus.png" />
        <p>Ubuntu-TR Sudo <a href="https://github.com/ubuntu-tr/ubuntu-tr.github.io">Github</a> desteği ile barındırılmaktadır.</p>
        <p>Tasarım: <a href="https://ubuntu-tr.net/">Ubuntu Türkiye</a> • Alt yapı: <a href="https://jekyllrb.com/">Jekyll</a></p>
        <img src="theme/ubuntu-tr/images/cc-by-sa2.png" />
        <p>Bu sitedeki makaleler <a href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA</a> lisansı altındadır.</p>
    </div>

</footer>


    </body>
</html>
